<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OpenAI Workbench</title>
  <link rel="stylesheet" href="../styles/global.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <script src="/gun-init.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
</head>
<body>
  <div class="top-buttons">
    <a href="../index.html">üè† Portal</a>
    <a href="../notes/">üìù Shared Notes</a>
    <a href="../tasks.html">‚úÖ Task Board</a>
    <a href="../games.html">üéÆ Mini Games</a>
    <a href="https://3dvr.tech/#subscribe" target="_blank">‚≠ê Subscribe</a>
    <a href="https://github.com/tmsteph/3dvr-portal" target="_blank">üöÄ GitHub</a>
  </div>

  <main>
    <header>
      <p class="eyebrow">AI co-pilot</p>
      <h1>OpenAI Workbench</h1>
      <p class="lede">Bring your own OpenAI API key, chat with GPT-4o, and share transcripts through GunDB.</p>
    </header>

    <section class="card info-card" aria-label="Deployment guides">
      <div class="card-header">
        <div>
          <p class="eyebrow">Instructions</p>
          <h2>Deployment guide hub</h2>
          <p class="meta">Step through GitHub PATs, Vercel tokens and IDs, and alias setup without leaving the Workbench.</p>
        </div>
        <a class="primary-link" href="../deployment-guides/index.html" target="_blank" rel="noreferrer">Open guides</a>
      </div>
      <p class="meta">Opens in a new tab so you can paste secrets directly into the panels below.</p>
    </section>

    <section class="card" id="api-key-panel" aria-label="API key configuration">
      <div class="card-header">
        <h2>Bring your own key</h2>
        <p class="meta">Keys stay in your browser; prompts and responses sync to GunDB so teams can reuse what worked.</p>
      </div>
      <label for="api-key">OpenAI API key</label>
      <div class="input-row">
        <input type="password" id="api-key" placeholder="sk-..." aria-describedby="api-key-help">
        <button id="save-key" class="primary">Save</button>
        <button id="clear-key" class="ghost">Clear</button>
      </div>
      <p id="api-key-help" class="meta">Stored only in localStorage on this device.</p>
      <p id="storage-mode" class="meta" aria-live="polite"></p>
      <p id="account-status" class="status" aria-live="polite">Connect your Gun account to sync keys across browsers.</p>
      <div class="input-row">
        <input type="password" id="default-passphrase" placeholder="Passphrase for admin default key">
        <button id="load-default" class="ghost">Use default key</button>
      </div>
      <p id="default-key-status" class="meta" aria-live="polite"></p>
    </section>

    <section class="card" id="vault-panel" aria-label="Gun key vault">
      <div class="card-header">
        <div>
          <p class="eyebrow">Sync</p>
          <h2>Gun secret vault</h2>
          <p class="meta">Encrypt any Workbench secret with a passphrase and keep it in Gun so it follows you across previews and devices.</p>
        </div>
      </div>

      <div class="grid compact-grid">
        <div>
          <label for="vault-alias">Vault label</label>
          <input id="vault-alias" type="text" placeholder="workbench-default" aria-describedby="vault-alias-help">
          <p id="vault-alias-help" class="meta">Letters, numbers, and dashes only. Use the same label on every device.</p>
        </div>
        <div>
          <label for="vault-passphrase">Passphrase</label>
          <input id="vault-passphrase" type="password" placeholder="Required to encrypt/decrypt" aria-describedby="vault-passphrase-help">
          <p id="vault-passphrase-help" class="meta">Passphrase never leaves the browser; it only decrypts your secret locally.</p>
        </div>
        <div>
          <label for="vault-target">Secret type</label>
          <select id="vault-target" aria-describedby="vault-target-help">
            <option value="openai">OpenAI API key</option>
            <option value="vercel">Vercel token</option>
            <option value="github">GitHub token</option>
          </select>
          <p id="vault-target-help" class="meta">Choose which field to pull from and where the decrypted secret should be applied.</p>
        </div>
      </div>

      <div class="input-row">
        <button id="vault-save" class="primary">Save secret to Gun</button>
        <button id="vault-load" class="ghost">Load secret from Gun</button>
      </div>

      <div class="auto-sync-row">
        <label class="checkbox-row" for="vault-auto-sync">
          <input id="vault-auto-sync" type="checkbox">
          <span>Auto-sync secrets to Gun after saving</span>
        </label>
        <label class="checkbox-row" for="vault-remember-passphrase">
          <input id="vault-remember-passphrase" type="checkbox">
          <span>Remember passphrase for this session</span>
        </label>
        <label class="checkbox-row" for="vault-use-account-alias">
          <input id="vault-use-account-alias" type="checkbox" checked>
          <span>Use my username as the vault label</span>
        </label>
        <label class="checkbox-row" for="vault-auto-load">
          <input id="vault-auto-load" type="checkbox" checked>
          <span>Auto-load secrets after signing in</span>
        </label>
      </div>

      <p id="vault-auto-status" class="meta" aria-live="polite">Enable auto-sync to encrypt secrets immediately after you save them.</p>
      <p id="vault-status" class="status" aria-live="polite">Use the vault to keep keys, tokens, and other secrets handy when Vercel preview URLs change.</p>
    </section>

    <section class="grid">
      <section class="card" id="chat-panel" aria-label="Chat controls">
        <div class="card-header">
          <div>
            <p class="eyebrow">Compose</p>
            <h2>Chat with Codex</h2>
            <p class="meta">Pick a model, type a prompt, and stream the reply into the shared history.</p>
          </div>
          <label class="select-group" for="model-select">
            <span>Model</span>
            <select id="model-select">
              <option value="gpt-4o" selected>gpt-4o</option>
              <option value="gpt-4o-mini">gpt-4o-mini</option>
            </select>
          </label>
        </div>

        <label for="message">Your prompt</label>
        <textarea id="message" placeholder="Ask for code, content, or portal edits..." rows="4"></textarea>
        <button id="submit-btn" class="primary">Send to OpenAI</button>

        <label for="output">Assistant response</label>
        <div id="output" class="output">Waiting for response...</div>
      </section>

      <section class="card" id="preview-panel" aria-label="Live preview">
        <div class="card-header">
          <div>
            <p class="eyebrow">Prototype</p>
            <h2>Live preview</h2>
            <p class="meta">Apply HTML/CSS answers in a sandbox to test ideas before committing them.</p>
          </div>
          <button id="apply-preview" class="ghost">Apply response</button>
        </div>
        <iframe id="response-preview" title="AI response preview" sandbox="">
          Your browser does not support iframes.
        </iframe>
      </section>
    </section>

    <section class="card" id="history-panel" aria-label="Shared transcript">
      <div class="card-header">
        <div>
          <p class="eyebrow">Reuse</p>
          <h2>Shared transcript</h2>
          <p class="meta">Entries are stored at <code>ai/workbench/&lt;sessionId&gt;</code> in Gun so teammates can find successful prompts.</p>
        </div>
      </div>
      <ul id="history"></ul>
    </section>

    <section class="grid">
      <section class="card" id="vercel-panel" aria-label="Vercel deployment">
        <div class="card-header">
          <div>
            <p class="eyebrow">Publish</p>
            <h2>Deploy to Vercel</h2>
            <p class="meta">Turn the current response into a live site by deploying a static <code>index.html</code>.</p>
          </div>
        </div>

        <label for="vercel-token">Vercel token</label>
        <div class="input-row">
          <input type="password" id="vercel-token" placeholder="Access token from Vercel settings" aria-describedby="vercel-help">
          <button id="save-vercel" class="primary">Save</button>
          <button id="clear-vercel" class="ghost">Clear</button>
        </div>
        <p id="vercel-help" class="meta">Token stays in localStorage; the deployment request is proxied through this domain. <a href="../deployment-guides/index.html" target="_blank" rel="noreferrer">Need the steps?</a></p>

        <div class="grid compact-grid">
          <div>
            <label for="vercel-project">Project name</label>
            <input id="vercel-project" type="text" placeholder="my-ai-site" aria-describedby="project-help">
            <p id="project-help" class="meta">Letters, numbers, and dashes only. A new Vercel project will be created if needed.</p>
          </div>
          <div>
            <label for="deploy-note">Notes</label>
            <input id="deploy-note" type="text" placeholder="What changed in this deployment?">
          </div>
        </div>

        <button id="deploy-btn" class="primary">Deploy current response</button>
        <div id="vercel-status" class="output" aria-live="polite">Paste your token and project name to start.</div>
      </section>

      <section class="card" id="deploy-history" aria-label="Deployment history">
        <div class="card-header">
          <div>
            <p class="eyebrow">Audit</p>
            <h2>Recent deployments</h2>
            <p class="meta">Saved to <code>ai/vercel/&lt;sessionId&gt;</code> in Gun so the team can reuse URLs.</p>
          </div>
        </div>
        <ul id="deployments"></ul>
      </section>
    </section>

    <section class="grid">
      <section class="card" id="github-panel" aria-label="GitHub publishing">
        <div class="card-header">
          <div>
            <p class="eyebrow">Commit</p>
            <h2>Publish to GitHub</h2>
            <p class="meta">Save the generated HTML into a repository so teammates can track changes.</p>
          </div>
        </div>

        <label for="github-token">GitHub token</label>
        <div class="input-row">
          <input type="password" id="github-token" placeholder="GitHub personal access token" aria-describedby="github-help">
          <button id="save-github" class="primary">Save</button>
          <button id="clear-github" class="ghost">Clear</button>
        </div>
        <p id="github-help" class="meta">Token stays in localStorage; commits use the GitHub contents API. <a href="../deployment-guides/index.html" target="_blank" rel="noreferrer">Open the guide</a> for PAT scopes.</p>

        <div class="grid compact-grid">
          <div>
            <label for="github-repo">Repository (owner/name)</label>
            <input id="github-repo" type="text" placeholder="org/website-repo" aria-describedby="repo-help">
            <p id="repo-help" class="meta">The repo must already exist and your token must grant contents access.</p>
          </div>
          <div>
            <label for="github-branch">Branch</label>
            <input id="github-branch" type="text" placeholder="main" value="main">
          </div>
        </div>

        <div class="grid compact-grid">
          <div>
            <label for="github-path">File path</label>
            <input id="github-path" type="text" placeholder="openai-output/index.html" value="index.html">
          </div>
          <div>
            <label for="github-message">Commit message</label>
            <input id="github-message" type="text" placeholder="Publish latest AI output">
          </div>
        </div>

        <button id="github-btn" class="primary">Publish current response</button>
        <div id="github-status" class="output" aria-live="polite">Add your token and repo to push HTML.</div>
      </section>

      <section class="card" id="github-history-panel" aria-label="GitHub history">
        <div class="card-header">
          <div>
            <p class="eyebrow">Record</p>
            <h2>Recent commits</h2>
            <p class="meta">Saved to <code>ai/github/&lt;sessionId&gt;</code> in Gun to track publish events.</p>
          </div>
        </div>
        <ul id="github-history"></ul>
      </section>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
